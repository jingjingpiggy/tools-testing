#!/bin/sh -xeu

project="$1"
repo="$2"
packages="$3"

if [ -e /usr/bin/apt-get -a -d /etc/apt/sources.list.d/ ] ; then
   srclist="/etc/apt/sources.list.d/Tools.list"
   echo "deb http://download.otctools.jf.intel.com/home:/tester:/$project/$repo/ /" >  $srclist
   echo "deb http://download.otctools.jf.intel.com/home:/tester:/Tools/$repo/ /" >> $srclist
   apt-get update
   apt-get upgrade -y
   apt-get install -y --force-yes $packages
elif [ -e /usr/bin/zypper -a -d /etc/zypp/repos.d ] ; then
   zypper ar -fG http://download.otctools.jf.intel.com/home%3A/tester%3A/$project/$repo/ $project
   zypper ar -fG http://download.otctools.jf.intel.com/home%3A/tester%3A/Tools/$repo/ tools
   sed -ie 's/%25/%/g' /etc/zypp/repos.d/tools.repo
   sed -ie 's/%25/%/g' /etc/zypp/repos.d/$project.repo
   zypper --non-interactive ref
   zypper --non-interactive install $packages
fi
